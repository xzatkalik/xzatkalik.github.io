<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><link type="text/css" rel="stylesheet" href="style1.css" media="screen" /><title>Tiny PXE Server</title></head><body><font> 
 
 
 
<p> 
<select ONCHANGE="location = this.options[this.selectedIndex].value;"> 
<option value="" disabled></option> 
<option value="../index.html">Contents</option> 
<option value="" disabled>=======</option> 
<option value="pxesrv_about.htm">Introduction</option> 
<option value="pxesrv_settings.htm">Settings</option> 
<option value="pxesrv_gui.htm">GUI Settings</option> 
<option value="pxesrv_config.htm">Config.ini settings</option> 
<option value="pxesrv_service.htm">Run as Service</option> 
<option value="firewall.htm">Firewall Settings</option> 
<option value="test_system.htm">Test System(s)</option> 
<option value="misc.htm">Miscellaneous</option> 
<option value="troubleshooting.htm">Troubleshooting</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot Loaders</option> 
<option value="" disabled>==========</option> 
<option value="pxelinux.htm">PXELINUX</option> 
<option value="grub4dos.htm">Grub4Dos</option> 
<option value="ipxe.htm">iPXE</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot</option> 
<option value="" disabled>====</option> 
<option value="fdd.htm">Floppy Disk Image</option> 
<option value="iso.htm">ISO Image</option> 
<option value="" disabled></option> 
<option value="" disabled>Linux</option> 
<option value="" disabled>=====</option> 
<option value="centos_netinstall.htm">CentOS - Network...</option> 
<option value="debian_netinstall.htm">Debian - Network...</option> 
<option value="fatdog.htm">FatDog</option> 
<option value="gparted.htm">GPartEd</option> 
<option value="ubuntu.htm">ubuntu/Lubuntu</option> 
<option value="ubuntu_netinstall.htm">ubuntu - Network...</option> 
<option value="" disabled></option> 
<option value="" disabled>WinPE</option> 
<option value="" disabled>=====</option> 
<option value="winpe.htm">WinPE</option> 
<option value="winpe_wimboot.htm">WinPE (wimboot)</option> 
<option value="winpe_bcd.htm">Multiple WinPE</option> 
<option value="" disabled></option> 
<option value="" disabled>Net Install Windows</option> 
<option value="" disabled>===============</option> 
<option value="ris.htm">RIS</option> 
<option value="ris_issues.htm">Troubleshooting RIS</option> 
<option value="win6x.htm">Install Windows NT 6.*</option> 
<option value="win5x.htm">Install Windows NT 5.*</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (AoE)</option> 
<option value="" disabled>================</option> 
<option value="aoe_target.htm">AoE (Windows T...</option> 
<option value="aoe_install_winnt5.htm">AoE (Install Driver...</option> 
<option value="aoe_install_winnt6.htm">AoE (Install Driver...</option> 
<option value="aoe.htm">AoE (Clone...</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (iSCSI)</option> 
<option value="" disabled>================</option> 
<option value="iscsi_targets.htm">iSCSI (Windows T...</option> 
<option value="iscsi_kernsafe.htm">iSCSI (Kernsafe...</option> 
<option value="iscsi_ms.htm" selected="selected">iSCSI (Microsoft...</option> 
<option value="iscsi_pytarget.htm">iSCSI (pyTarget)</option> 
<option value="iscsi.htm">iSCSI (Clone...</option> 
<option value="iscsi_install.htm">iSCSI (Install...</option> 
<option value="iscsi_centos.htm">iSCSI ...CentOS</option> 
<option value="iscsi_ubuntu.htm">iSCSI ...ubuntu</option> 
<option value="iscsi_ubuntu_netinstall.htm">iSCSI ...ubuntu (2)</option> 
<option value="" disabled></option> 
<option value="" disabled>Miscellaneous</option> 
<option value="" disabled>===========</option> 
<option value="clone.htm">Capture Windows...</option> 
<option value="clone_strarc.htm">Copy Windows...</option> 
<option value="service.htm">Network Adapter C...</option> 
<option value="wfplwf.htm">Unbinding The Light...</option> 
<option value="forensics.htm">Digital Forensic Acq...</option> 
<option value="ipxe_build.htm">iPXE - How to...</option> 
<option value="" disabled></option> 
<option value="" disabled>Appendices</option> 
<option value="" disabled>=========</option> 
<option value="pxesrv_zip.htm">Contents of pxesrv.zip</option> 
<option value="pxesrv_faq.htm">Erwan's FAQ</option> 
<option value="ack.htm">Acknowledgements...</option> 
<option value="" disabled></option> 
</select> 
</p> 
 
 
 
<hr> 
<img src="img/logo6.jpg" BORDER=1></a> 
 



<h2 align="center"><u>iSCSI (Microsoft iSCSI Software Target)</u></h2>



<p>
This page contains the following sections -
<ul>
<li><a class="glossary" href="iscsi_ms.htm#install">Installing Microsoft iSCSI Software Target</a></li>
<li><a class="glossary" href="iscsi_ms.htm#target">Create Target</a></li>
<li><a class="glossary" href="iscsi_ms.htm#vhd">Create VHD</a></li>
<li><a class="glossary" href="iscsi_ms.htm#authenticate">Client/Host Connections</a></li>
</ul>
</p>











<a name="install"></a>
<h3 class="breaktop"><u>Installing Microsoft iSCSI Software Target</u></h3>



<p>
Default settings can be used when installing the Microsoft iSCSI Software Target. <b><u><font color="red">NOTE</font></u></b> - the installer will only run on Windows Server 2008 R2 (including SP1) - other versions will display an error message "<i>Installation is not supported on this operating system</i>". There are some instructions for modifying the installer to run on other <b><u>64-bit</u></b> versions of Windows, however this is not officially supported (see <a class="glossary" target="_blank" href="https://jeffchiu.wordpress.com/2009/07/23/kb-microsoft-iscsi-software-target-3-2-msi-package-hack-for-sku-limitation/">here</a>). 
<br />
<img src="img/mstargetinstall.jpg" border=1>
</p>



<p>

</p>










<a name="target"></a>
<h3 class="breaktop"><u>Create Target</u></h3>


<div>
Right-click on <font class="file">iSCSI Targets</font> (in the left panel) &gt; select <font class="file">Create iSCSI Target</font> - 
<br >
<a href="img/mstarget001.jpg"><IMG SRC="img/mstarget001.jpg" float=left width=80% margin-right=1% margin-bottom=0.5em border=1></a>
</div>


<p class="breaktop">
<u>Welcome to the Create iSCSI Target Wizard</u><br />
Click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget002.jpg" border=1>
</p>


<p class="breaktop">
<u>iSCSI Target Identification</u><br />
Enter a name for the <font class="file">Target</font> in the <font class="file">iSCSI target name:</font> field. E.g. <font class="file">iqn.iSCSI-target1</font> &gt; enter a description (optional - not required) &gt; click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget004.jpg" border=1>
</p>


<p class="breaktop">
<a name="client_iqn"></a>
<u>iSCSI Initiators Identifiers</u><br />
A <font class="file">Client</font> identifier is required to authenticate any connections to the <font class="file">Target</font>. Enter the <font class="file">Client</font> IQN in the <font class="file">IQN identifier:</font> field. Connections will fail from any <font class="file">Client</font>(s) not specified. IP or MAC addresses can be used as an alternative to IQN (click on the <font class="file"><u>A</u>dvanced...</font> button to configure) &gt; click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget005.jpg" border=1>
</p>


<p class="breaktop">
<u>Completing the Create iSCSI Target Wizard</u><br />
Click on the <font class="file">Finish</font> button - 
<br />
<img src="img/mstarget006.jpg" border=1>
</p>




<div class="breaktop">
Right-click on <font class="file">iqn.iSCSI-target1</font> (in the left panel) and select <font class="file">Properties</font> - 
<br >
<a href="img/mstarget015.jpg"><IMG SRC="img/mstarget015.jpg" float=left width=80% margin-right=1% margin-bottom=0.5em border=1></a>
</div>


<p class="breaktop">
As you can see from the property box below, although the <font class="file">Name:</font> was set as <font class="file">iqn.iSCSI-target1</font>, the <font class="file">IQN:</font> has been generated by the software... 
<font class="file"></font> &gt; <font class="file"><u>N</u>ext &gt;</font> - 
<br />
<img src="img/mstarget016.jpg" border=1>
</p>



<p class="breaktop">
Change the <font class="file">IQN:</font> to <font class="file">iqn.iSCSI-target1</font>  &gt; <font class="file">OK</font> -  
<br />
<img src="img/mstarget017.jpg" border=1>
</p>






<a name="vhd"></a>
<h3 class="breaktop"><u>Create VHD</u></h3>


<div>
To create a VHD file for the <font class="file">Target</font> created in the preceding steps, right-click on <font class="file">iqn.iSCSI-target1</font> (in the left pane) and select <font class="file">Create Virtual Disk for iSCSI Target</font> - 
<br >
<a href="img/mstarget008.jpg"><IMG SRC="img/mstarget008.jpg" float=left width=80% margin-right=1% margin-bottom=0.5em border=1></a>
</div>

<p class="breaktop">
<u>Welcome to the Create Virtual Disk Wizard</u><br />
Click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget009.jpg" border=1>
</p>

<p class="breaktop">
<u>File</u><br />
Enter a path for a VHD file (including full path and file extension) - E.g.  <font class="file">D:\iSCSI_target1.vhd</font> &gt; click on the <font class="file"><u>N</u>ext &gt;</font> button -  
<br />
<img src="img/mstarget010.jpg" border=1>
</p>

<p class="breaktop">
<u>Size</u><br />
Note that if installing Windows to the iSCSI <font class="file">Target</font>, setup will refuse to run if the minimum disk space requirements are not met (Windows 7 - 16 GB available hard disk space (32-bit) or 20 GB (64-bit)). Enter a size for the VHD. E.g. 
<font class="file">20480</font> &gt; click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget011.jpg" border=1>
</p>

<p class="breaktop">
<u>Description</u><br />
The <font class="file">Virtual disk description:</font> is optional - complete as required &gt; click on the <font class="file"><u>N</u>ext &gt;</font> button - 
<br />
<img src="img/mstarget012.jpg" border=1>
</p>

<p class="breaktop">
<u>Completing the Create Virtual Disk Wizard</u><br />
Click on the <font class="file">Finish</font> button - 
<br />
<img src="img/mstarget013.jpg" border=1>
</p>









<a name="authenticate"></a>
<h3 class="breaktop"><u>Client/Host Connections</u></h3>

<p>
As stated in the <a class="glossary" href="iscsi_ms.htm#target">Create Target</a> section of this page, connections from <font class="file">Client</font>/<font class="file">Host</font> systems will require authentication. Assuming that the <font class="file">Client</font>/<font class="file">Host</font> identifier was set as <font class="file">iqn.client</font> (see <a class="glossary" href="iscsi_ms.htm#client_iqn">here</a>), add the following command to your iPXE script -
<ul>
<li><font class="file">set initiator-iqn iqn.client</font> </li>
</ul>
</p>


<p>
E.g. -
<br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>
#!ipxe
set boot-url http://${dhcp-server}
set gateway 0.0.0.0
set keep-san 1
set initiator-iqn iqn.client
SANBOOT iscsi:${dhcp-server}::::iqn.iSCSI-target1
</textarea>
</p>





<p class="breaktop"><font class="file">Document date - 28<sup>th</sup> February 2017(DRAFT)</font></p></font></body></html>
