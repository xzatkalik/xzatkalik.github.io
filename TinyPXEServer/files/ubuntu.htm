<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><link type="text/css" rel="stylesheet" href="style1.css" media="screen" /><title>Tiny PXE Server</title></head><body><font> 
 
 
 
<p> 
<select ONCHANGE="location = this.options[this.selectedIndex].value;"> 
<option value="" disabled></option> 
<option value="../index.html">Contents</option> 
<option value="" disabled>=======</option> 
<option value="pxesrv_about.htm">Introduction</option> 
<option value="pxesrv_settings.htm">Settings</option> 
<option value="pxesrv_gui.htm">GUI Settings</option> 
<option value="pxesrv_config.htm">Config.ini settings</option> 
<option value="pxesrv_service.htm">Run as Service</option> 
<option value="firewall.htm">Firewall Settings</option> 
<option value="test_system.htm">Test System(s)</option> 
<option value="misc.htm">Miscellaneous</option> 
<option value="troubleshooting.htm">Troubleshooting</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot Loaders</option> 
<option value="" disabled>==========</option> 
<option value="pxelinux.htm">PXELINUX</option> 
<option value="grub4dos.htm">Grub4Dos</option> 
<option value="ipxe.htm">iPXE</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot</option> 
<option value="" disabled>====</option> 
<option value="fdd.htm">Floppy Disk Image</option> 
<option value="iso.htm">ISO Image</option> 
<option value="" disabled></option> 
<option value="" disabled>Linux</option> 
<option value="" disabled>=====</option> 
<option value="centos_netinstall.htm">CentOS - Network...</option> 
<option value="debian_netinstall.htm">Debian - Network...</option> 
<option value="fatdog.htm">FatDog</option> 
<option value="gparted.htm">GPartEd</option> 
<option value="ubuntu.htm" selected="selected">ubuntu/Lubuntu</option> 
<option value="ubuntu_netinstall.htm">ubuntu - Network...</option> 
<option value="" disabled></option> 
<option value="" disabled>WinPE</option> 
<option value="" disabled>=====</option> 
<option value="winpe.htm">WinPE</option> 
<option value="winpe_wimboot.htm">WinPE (wimboot)</option> 
<option value="winpe_bcd.htm">Multiple WinPE</option> 
<option value="" disabled></option> 
<option value="" disabled>Net Install Windows</option> 
<option value="" disabled>===============</option> 
<option value="ris.htm">RIS</option> 
<option value="ris_issues.htm">Troubleshooting RIS</option> 
<option value="win6x.htm">Install Windows NT 6.*</option> 
<option value="win5x.htm">Install Windows NT 5.*</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (AoE)</option> 
<option value="" disabled>================</option> 
<option value="aoe_target.htm">AoE (Windows T...</option> 
<option value="aoe_install_winnt5.htm">AoE (Install Driver...</option> 
<option value="aoe_install_winnt6.htm">AoE (Install Driver...</option> 
<option value="aoe.htm">AoE (Clone...</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (iSCSI)</option> 
<option value="" disabled>================</option> 
<option value="iscsi_targets.htm">iSCSI (Windows T...</option> 
<option value="iscsi_kernsafe.htm">iSCSI (Kernsafe...</option> 
<option value="iscsi_ms.htm">iSCSI (Microsoft...</option> 
<option value="iscsi_pytarget.htm">iSCSI (pyTarget)</option> 
<option value="iscsi.htm">iSCSI (Clone...</option> 
<option value="iscsi_install.htm">iSCSI (Install...</option> 
<option value="iscsi_centos.htm">iSCSI ...CentOS</option> 
<option value="iscsi_ubuntu.htm">iSCSI ...ubuntu</option> 
<option value="iscsi_ubuntu_netinstall.htm">iSCSI ...ubuntu (2)</option> 
<option value="" disabled></option> 
<option value="" disabled>Miscellaneous</option> 
<option value="" disabled>===========</option> 
<option value="clone.htm">Capture Windows...</option> 
<option value="clone_strarc.htm">Copy Windows...</option> 
<option value="service.htm">Network Adapter C...</option> 
<option value="wfplwf.htm">Unbinding The Light...</option> 
<option value="forensics.htm">Digital Forensic Acq...</option> 
<option value="ipxe_build.htm">iPXE - How to...</option> 
<option value="" disabled></option> 
<option value="" disabled>Appendices</option> 
<option value="" disabled>=========</option> 
<option value="pxesrv_zip.htm">Contents of pxesrv.zip</option> 
<option value="pxesrv_faq.htm">Erwan's FAQ</option> 
<option value="ack.htm">Acknowledgements...</option> 
<option value="" disabled></option> 
</select> 
</p> 
 
 
 
<hr> 
<img src="img/logo6.jpg" BORDER=1></a> 
 



<h2 align="center"><u>Ubuntu/Lubuntu</u></h2>




<p>
Ubuntu is a popular Linux Distro based upon Debian, available in 32-bit and 64-bit versions. Ubuntu can run as a live system or alternatively it can be installed to a local hard disk. Ubuntu version 11.04 (32-bit) was used during testing for the original version of this guide - version 16.04 is also working. For more information about Ubuntu refer to <a target="_blank" href="http://www.ubuntu.com/">http://www.ubuntu.com/</a>.
<ul>
<li><a class="glossary" href="ubuntu.htm#files">Required Files</a></li>
<li><a class="glossary" href="ubuntu.htm#nfs">Create NFS Share</a></li>
<li><a class="glossary" href="ubuntu.htm#pxelinux">pxelinux settings</a></li>
<li><a class="glossary" href="ubuntu.htm#grub4dos">grub4dos settings</a></li>
<li><a class="glossary" href="ubuntu.htm#ipxe">iPXE settings</a></li>
<li><a class="glossary" href="ubuntu.htm#ipxe_scripts">iPXE Scripts</a></li>
<li><a class="glossary" href="ubuntu.htm#nfsroot">nfsroot Syntax</a></li>
</ul>
</p>


<div>
<br >
<a href="img/ubuntu1.jpg"><IMG SRC="img/ubuntu1.jpg" float=left width=90% margin-right=1% margin-bottom=0.5em border=1></a>
</div>


<div class="break3em">
These instructions may also work on ubuntu derivatives - lubuntu version 16.04 booted successfully in tests.
<br >
<a href="img/lubuntu1.jpg"><IMG SRC="img/lubuntu1.jpg" float=left width=90% margin-right=1% margin-bottom=0.5em border=1></a>
</div>







<a name="files"></a>
<h3 class="breaktop"><u>Required Files</u></h3>



<p>
To PXE Boot Ubuntu 11.04, download the ISO file from <a class="glossary" target="_blank" href="http://old-releases.ubuntu.com/releases/">http://old-releases.ubuntu.com/releases/</a>. 
</p>



<p>
Now create the folder <font class="file">\ubuntu1104\</font> in your <font class="file">Tiny PXE Server</font> root directory - e.g. <font class="file">C:\pxesrv\files\ubuntu1104\</font>.
</p>



<p>
Now extract the <font class="file">casper</font> directory from the ISO (mount the ISO file using ImDisk, or extract using 7-zip, or use a tool of your choice) and copy it to <font class="file">C:\pxesrv\files\ubuntu1104\</font>. Your <font class="file">Tiny PXE Server</font> directory structure should contain the following files (files may differ if using an alternative version of ubuntu) -
<ul>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\filesystem.manifest</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\filesystem.manifest-desktop</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\filesystem.size</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\filesystem.squashfs</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\initrd.lz</font></li>
<li><font class="file">C:\pxesrv\files\ubuntu1104\casper\vmlinuz</font></li>
</ul>
</p>



<p>
<b><u><font color="red">NOTE</font></u></b> - on 64-bit builds you may need to replace references to <font class="file">vmlinuz</font> with <font class="file">vmlinuz.efi</font>. 
</p>












<a name="nfs"></a>
<h3 class="breaktop"><u>Create NFS Share</u></h3>


<p>
To PXE boot Ubuntu Linux a Network File System (NFS) share is required - it is not possible to boot directly from the ISO file. 
</p>


<p>
The <font class="file">C:\pxesrv\files\ubuntu1104\</font> directory will need to be shared - the <font class="file">WinNFSd</font> server included in the <font class="file">Tint PXE Server</font> download package can be used to do this. Extract <font class="file">winnfsd.exe</font> from <font class="file">WinNFSd-2.0.zip</font> to <font class="file">C:\pxesrv\</font>. Now run the following command to share the <font class="file">C:\pxesrv\files\ubuntu1104\</font> directory (editing the paths as required to suit your own setup) -
<br />

<textarea style="font-size:12px" cols="80" rows="3" align="left" readonly>

C:\pxesrv\winnfsd.exe -id 0 0 c:\pxesrv\files\ubuntu1104
</textarea>
<br />
<b>Note</b> - Running the above command will start WinNFSd in a command window - leave this window open as closing it will stop sharing the folder.
<br />
<IMG SRC="img/winnfsd.jpg">
</p>


<p>
Now add a menu entry for your preferred Network Bootstrap Program -
<ul>
<li><a class="glossary" href="ubuntu.htm#pxelinux">pxelinux settings</a></li>
<li><a class="glossary" href="ubuntu.htm#grub4dos">grub4dos settings</a></li>
<li><a class="glossary" href="ubuntu.htm#ipxe">iPXE settings</a></li>
<li><a class="glossary" href="ubuntu.htm#ipxe_scripts">iPXE Scripts</a></li>
</ul>
</p>























<a name="pxelinux"></a>
<h3 class="breaktop"><u>pxelinux settings</u></h3>


<p>
Remember to ensure that the required files are copied to your <font class="file">Tiny PXE Server</font> root directory - 
<ul>
<li><font class="file">C:\pxesrv\files\pxelinux.0</font></li>
<li><font class="file">C:\pxesrv\files\menu.c32</font></li> 
<li><font class="file">C:\pxesrv\files\pxelinux.cfg\default</font></li>
</ul>
</p>


<p>
Add the following to <font class="file">C:\pxesrv\files\pxelinux.cfg\default</font> (create this file if required) -
<br />
<textarea style="font-size:12px" cols="80" rows="10" align="left" wrap="OFF" readonly>

LABEL Ubuntu
MENU LABEL Ubuntu (Version 11.04)
KERNEL ubuntu1104/casper/vmlinuz
APPEND root=/dev/nfs boot=casper netboot=nfs nfsroot=192.168.2.1:/c/pxesrv/files/ubuntu1104 initrd=ubuntu1104/casper/initrd.lz quiet splash --

</textarea>
</p>


<p>
The parameter containing the path to the NFS share may need to be edited to suit your own setup - for the syntax, refer to the <a href="ubuntu.htm#nfsroot">nfsroot Syntax</a> section.
</p>


<p>
Click on one of the following for sample <font class="file">config.ini</font> settings (edit to reflect your own setup) -
<ul>
<li><b>DHCP</b> - <a href="txt/config_dhcp_pxelinux1.txt">here</a></li>
<li><b>Proxy DHCP</b> - <a href="txt/config_proxydhcp_pxelinux1.txt">here</a></li>
</ul>
</p>







<a name="grub4dos"></a>
<h3 class="breaktop"><u>grub4dos settings</u></h3>


<p>
Remember to ensure that the required files are copied to your <font class="file">Tiny PXE Server</font> root directory - 
<ul>
<li><font class="file">C:\pxesrv\files\grldr</font></li>
<li><font class="file">C:\pxesrv\files\menu.lst\default</font></li>
</ul>
</p>


<p>
Add the following to <font class="file">C:\pxesrv\files\menu.lst\default</font> (create this file if required) -
<br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>

title Ubuntu (Version 11.04)
kernel (pd)/ubuntu1104/casper/vmlinuz root=/dev/nfs boot=casper netboot=nfs nfsroot=192.168.2.1:/c/pxesrv/files/ubuntu1104 quiet splash --
initrd (pd)/ubuntu1104/casper/initrd.lz

</textarea>
</p>


<p>
The parameter containing the path to the NFS share may need to be edited to suit your own setup - for the syntax, refer to the <a href="ubuntu.htm#nfsroot">nfsroot Syntax</a> section.
</p>


<p>
Click on one of the following for <font class="file">config.ini</font> settings (edit to reflect your own setup) -
<ul>
<li><b>DHCP</b> - <a href="txt/config_dhcp_grldr1.txt">here</a></li>
<li><b>Proxy DHCP</b> - <a href="txt/config_proxydhcp_grldr1.txt">here</a></li>
</ul>
</p>













<a name="ipxe"></a>
<h3 class="breaktop"><u>iPXE settings</u></h3>



<p>
Remember to ensure that the required files are copied to your <font class="file">Tiny PXE Server</font> root directory - 
<ul>
<li><font class="file">C:\pxesrv\files\ipxe.pxe</font> (or <font class="file">C:\pxesrv\files\ipxe-undionly.kpxe</font>)</li>
<li><font class="file">C:\pxesrv\files\ipxe_menu.txt</font></li> 
</ul>
</p>


<p>
Add the following to the menu section of <font class="file">C:\pxesrv\files\ipxe_menu.txt</font> (create this file if required) -
<br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>

item ubuntu        Ubuntu (Version 11.04)
</textarea>
</p>



<p>
Add the following to the menu options section of <font class="file">C:\pxesrv\files\ipxe_menu.txt</font> -
<br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>
:ubuntu
kernel ${boot-url}/ubuntu1104/casper/vmlinuz root=/dev/nfs boot=casper netboot=nfs nfsroot=${dhcp-server}:/c/pxesrv/files/ubuntu1104 quiet splash --
initrd ${boot-url}/ubuntu1104/casper/initrd.lz
boot
</textarea>
</p>






<p>
E.g. - 
<br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>

#!ipxe
#============== Set Variables ===============
set boot-url http://${dhcp-server}

#================ Main Menu =================
menu iPXE boot menu
item ubuntu        Ubuntu (Version 11.04)
choose target && goto ${target}

#============ Main Menu Options =============
:ubuntu
kernel ${boot-url}/ubuntu1104/casper/vmlinuz root=/dev/nfs boot=casper netboot=nfs nfsroot=${dhcp-server}:/c/pxesrv/files/ubuntu1104 quiet splash --
initrd ${boot-url}/ubuntu1104/casper/initrd.lz
boot

</textarea>
<br />
<b>NOTE</b> - remember to change <font class="file">set boot-url http://${dhcp-server}</font> if using ProxyDHCP.
</p>


<p>
The parameter containing the path to the NFS share may need to be edited to suit your own setup - for the syntax, refer to the <a href="ubuntu.htm#nfsroot">nfsroot Syntax</a> section.
</p>


<p>
Click on one of the following for <font class="file">config.ini</font> settings (edit to reflect your own setup) -
<ul>
<li><b>DHCP</b> - <a href="txt/config_dhcp_ipxe1.txt">here</a></li>
<li><b>Proxy DHCP</b> - <a href="txt/config_proxydhcp_ipxe1.txt">here</a></li>
</ul>
</p>









<a name="ipxe_scripts"></a>
<h3 class="breaktop"><u>iPXE Scripts</u></h3>


<p>
<font class="file">iPXE</font> menus are essentially complicated scripts. It's also possible to specify a script using the <a class="glossary" href="pxesrv_config.htm#altfilename">altfilename</a> option in <font class="file">config.ini</font>. <b>NOTE</b> - remember to change <font class="file">set boot-url http://${dhcp-server}</font> if using ProxyDHCP.
</p>



<p>
Sample <font class="file">iPXE</font> script - <br />
<textarea style="font-size:12px" cols="80" rows="10" align=left wrap=off readonly>

#!ipxe
set boot-url http://${dhcp-server}
kernel ${boot-url}/ubuntu1104/casper/vmlinuz root=/dev/nfs boot=casper netboot=nfs nfsroot=${dhcp-server}:/c/pxesrv/files/ubuntu1104 quiet splash --
initrd ${boot-url}/ubuntu1104/casper/initrd.lz
boot
</textarea>
</p>


















<a name="nfsroot"></a>
<h3 class="breaktop"><u>nfsroot Syntax</u></h3>


<p>
The parameter containing the path to the NFS share may need to be edited to suit your own setup. Syntax is -
<br />
<textarea style="font-size:12px" cols="80" rows="3" align="left" readonly>
nfsroot=SERVER_IP_ADDRESS:NFS_SHARENAME
</textarea>
</p>


<p>
Where -
<ul>
<li><b>SERVER_IP_ADDRESS</b> - is the IP (v4) address of the SERVER. If using iPXE then we can use the iPXE <font class="file">${dhcp-server}</font> variable (or <font class="file">${next-server}</font> if using Proxy DHCP). If using Grub4dos or PXELINUX then the IP address will need to be specified in full. </li>
</ul>

<ul>
<li><b>NFS_SHARENAME</b> - is the sharename for the NFS share containing the <font class="file">casper</font> directory. If using <font class="file">WinNFSd</font> the sharename is <u>based</u> on the path to the directory being shared. For example <font class="file">C:\pxesrv\files\ubuntu1104</font> - NFS_SHARENAME is <font class="file">/c/pxesrv/files/ubuntu1104</font> (note that the drive letter is not followed by a colon (<b>:</b>)). </li>
</ul>
</p>



<p>
Assuming the SERVER IP Address is 192.168.2.1 and the path to the NFS share is <font class="file">C:\pxesrv\files\ubuntu1104\</font> we would use the following in the nfsroot parameter in the PXELINUX, Grub4dos and iPXE menus -
<br />
<textarea style="font-size:12px" cols="80" rows="3" align="left" readonly>
nfsroot=192.168.2.1:/c/pxesrv/files/ubuntu1104
</textarea>
</p>


<p>
Or alternatively for iPXE with <font class="file">Tiny PXE Server</font> set as DHCP server -
<br />
<textarea style="font-size:12px" cols="80" rows="3" align="left" readonly>
nfsroot=${dhcp-server}:/c/pxesrv/files/ubuntu1104
</textarea>
</p>



<p>
Or for iPXE with <font class="file">Tiny PXE Server</font> set as ProxyDHCP server -
<br />
<textarea style="font-size:12px" cols="80" rows="3" align="left" readonly>
nfsroot=${next-server}:/c/pxesrv/files/ubuntu1104
</textarea>
</p>











<p class="breakbottom">
</p>




<p class="breaktop"><font class="file">Document date - 28<sup>th</sup> February 2017(DRAFT)</font></p></font></body></html>