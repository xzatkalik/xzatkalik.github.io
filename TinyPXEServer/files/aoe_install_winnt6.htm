<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><link type="text/css" rel="stylesheet" href="style1.css" media="screen" /><title>Tiny PXE Server</title></head><body><font> 
 
 
 
<p> 
<select ONCHANGE="location = this.options[this.selectedIndex].value;"> 
<option value="" disabled></option> 
<option value="../index.html">Contents</option> 
<option value="" disabled>=======</option> 
<option value="pxesrv_about.htm">Introduction</option> 
<option value="pxesrv_settings.htm">Settings</option> 
<option value="pxesrv_gui.htm">GUI Settings</option> 
<option value="pxesrv_config.htm">Config.ini settings</option> 
<option value="pxesrv_service.htm">Run as Service</option> 
<option value="firewall.htm">Firewall Settings</option> 
<option value="test_system.htm">Test System(s)</option> 
<option value="misc.htm">Miscellaneous</option> 
<option value="troubleshooting.htm">Troubleshooting</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot Loaders</option> 
<option value="" disabled>==========</option> 
<option value="pxelinux.htm">PXELINUX</option> 
<option value="grub4dos.htm">Grub4Dos</option> 
<option value="ipxe.htm">iPXE</option> 
<option value="" disabled></option> 
<option value="" disabled>Boot</option> 
<option value="" disabled>====</option> 
<option value="fdd.htm">Floppy Disk Image</option> 
<option value="iso.htm">ISO Image</option> 
<option value="" disabled></option> 
<option value="" disabled>Linux</option> 
<option value="" disabled>=====</option> 
<option value="centos_netinstall.htm">CentOS - Network...</option> 
<option value="debian_netinstall.htm">Debian - Network...</option> 
<option value="fatdog.htm">FatDog</option> 
<option value="gparted.htm">GPartEd</option> 
<option value="ubuntu.htm">ubuntu/Lubuntu</option> 
<option value="ubuntu_netinstall.htm">ubuntu - Network...</option> 
<option value="" disabled></option> 
<option value="" disabled>WinPE</option> 
<option value="" disabled>=====</option> 
<option value="winpe.htm">WinPE</option> 
<option value="winpe_wimboot.htm">WinPE (wimboot)</option> 
<option value="winpe_bcd.htm">Multiple WinPE</option> 
<option value="" disabled></option> 
<option value="" disabled>Net Install Windows</option> 
<option value="" disabled>===============</option> 
<option value="ris.htm">RIS</option> 
<option value="ris_issues.htm">Troubleshooting RIS</option> 
<option value="win6x.htm">Install Windows NT 6.*</option> 
<option value="win5x.htm">Install Windows NT 5.*</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (AoE)</option> 
<option value="" disabled>================</option> 
<option value="aoe_target.htm">AoE (Windows T...</option> 
<option value="aoe_install_winnt5.htm">AoE (Install Driver...</option> 
<option value="aoe_install_winnt6.htm" selected="selected">AoE (Install Driver...</option> 
<option value="aoe.htm">AoE (Clone...</option> 
<option value="" disabled></option> 
<option value="" disabled>SANBOOT (iSCSI)</option> 
<option value="" disabled>================</option> 
<option value="iscsi_targets.htm">iSCSI (Windows T...</option> 
<option value="iscsi_kernsafe.htm">iSCSI (Kernsafe...</option> 
<option value="iscsi_ms.htm">iSCSI (Microsoft...</option> 
<option value="iscsi_pytarget.htm">iSCSI (pyTarget)</option> 
<option value="iscsi.htm">iSCSI (Clone...</option> 
<option value="iscsi_install.htm">iSCSI (Install...</option> 
<option value="iscsi_centos.htm">iSCSI ...CentOS</option> 
<option value="iscsi_ubuntu.htm">iSCSI ...ubuntu</option> 
<option value="iscsi_ubuntu_netinstall.htm">iSCSI ...ubuntu (2)</option> 
<option value="" disabled></option> 
<option value="" disabled>Miscellaneous</option> 
<option value="" disabled>===========</option> 
<option value="clone.htm">Capture Windows...</option> 
<option value="clone_strarc.htm">Copy Windows...</option> 
<option value="service.htm">Network Adapter C...</option> 
<option value="wfplwf.htm">Unbinding The Light...</option> 
<option value="forensics.htm">Digital Forensic Acq...</option> 
<option value="ipxe_build.htm">iPXE - How to...</option> 
<option value="" disabled></option> 
<option value="" disabled>Appendices</option> 
<option value="" disabled>=========</option> 
<option value="pxesrv_zip.htm">Contents of pxesrv.zip</option> 
<option value="pxesrv_faq.htm">Erwan's FAQ</option> 
<option value="ack.htm">Acknowledgements...</option> 
<option value="" disabled></option> 
</select> 
</p> 
 
 
 
<hr> 
<img src="img/logo6.jpg" BORDER=1></a> 
 



<h2 align="center"><u>AoE (Install Driver - Windows NT 6.*)</u></h2>


<p>
The screenshots in this section were captured on a Windows 7 (SP1) system. The instructions in this section also apply to installing AoE on Windows 8.1 (including Update 1) and possibly other NT 6.* versions of Windows. Attempts to network boot Windows 8/8.1/10 have so far proved unsuccessful when using the <font class="file">AoE</font> driver - try using iSCSI on these systems. 
</p>




<a name="aoe_signed"></a>
<h2 class="breaktop"><u>64-bit Driver Signing</u></h2>


<p>
Microsoft introduced a Driver Signing Policy in Windows Vista and later versions of Windows (see <a target="_blank" href="https://msdn.microsoft.com/en-us/library/windows/hardware/ff548231(v=vs.85).aspx">here</a>). Unsigned drivers, including the <font class="file">AoE</font> driver, cannot be installed in 64-bit versions of Windows <u>unless</u> certain settings are changed. The requirement for digitally signed drivers was introduced in 64-bit Windows as a security measure - unfortunately the costs of obtaining a digital certificate can be prohibitive. 
</p>


<p>
The current release of the WinAoE driver is version 0.97g - the official download (refer to the <a target="_blank" href="http://winaoe.org/">WinAoE</a> site) does not contain a digitally signed driver and I have not found a method of installing the official release on 64-bit Windows. An alternative self-signed version of the driver is available, however I am unsure of its origins - click <a class="glossary" target="_blank" href="tools/winaoe_signed.zip">here</a> to download the file(s). Unfortunately this alternative driver package is the only way of installing WinAoE on 64-bit versions of Windows. 
</p>


<p>
There are various documented methods for installing drivers without a valid digital signature (this includes the self-signed version of WinAoE), including combinations of the following -


<ul>
<li>Edit the <font class="file">BCD</font> store and set <font class="file">DDISABLE_INTEGRITY_CHECKS</font> - this setting should be applied to the <font class="file">{bootmgr}</font> object (e.g. <font class="file">bcdedit /set {bootmgr} loadoptions DDISABLE_INTEGRITY_CHECKS</font>).</li>
</ul>


<ul>
<li>Edit the <font class="file">BCD</font> store and set <font class="file">TESTSIGNING ON</font> - this setting should be applied to the Windows <font class="file">OSLOADER</font> object/entry in the <font class="file">BCD</font> store (the <font class="file">{default}</font> GUID can usually be used - e.g. <font class="file">bcdedit /set {default} TESTSIGNING ON</font>).</li>
</ul>

<ul>
<li>Edit the <font class="file">BCD</font> store and set <font class="file">nointegritychecks ON</font> - this setting should be applied to the Windows <font class="file">OSLOADER</font> object/entry in the <font class="file">BCD</font> store (the <font class="file">{default}</font> GUID can usually be used - e.g. <font class="file">bcdedit /set {default} nointegritychecks ON</font>).</li>
</ul>

<ul>
<li><font class="file">F8</font> (Advanced Boot Options) &gt; <font class="file">Disable Driver Signature Enforcement</font>. This setting does not persist when the system is restarted.</li>
</ul>

<ul>
<li>Changing group policy settings using <font class="file">gpedit.msc</font> (<font class="file">User Configuration</font> &gt; <font class="file">Administrative Templates</font> &gt; <font class="file">System</font> &gt; <font class="file">Driver Installation</font> - change settings in <font class="file">Code signing for device drivers</font>). On a Windows 7 (SP1) system this policy setting states that it only applies to <i>"...Windows Server 2003, Windows XP, and Windows 2000 operating systems..."</i>.</li>
</ul>

</p>




<p>
In my own tests the only reliable method I have found involved completing the following steps <i><u>BEFORE</u></i> installing the <font class="file">AoE</font> Driver -


<ol>
<li>Edit the system <font class="file">BCD</font> store and set <font class="file">TESTSIGNING ON</font> (run the following command in an administrator command prompt <font class="file">bcdedit /set {default} TESTSIGNING ON</font>). After applying this setting the system must be rebooted to apply the change. Following the reboot a <font class="file">Test Mode</font> watermark will appear on the desktop.</li>
</ol>

 
<ol start="2">
<li>
After checking the <font class="file">Test Mode</font> setting was applied correctly in <font class="file">step 1</font> &gt; reboot the PC and press the <font class="file">F8</font> key to enter the <font class="file">Advanced Boot Options</font> menu  &gt; select <font class="file">Disable Driver Signature Enforcement</font>. <b>Tip</b> - pressing the <font class="file">F8</font> key at the right time can be difficult - to automatically display the <font class="file">Advanced Boot Options</font> menu at start-up, edit the <font class="file">BCD</font> store and set <font class="file">ADVANCEDOPTIONS YES</font> (e.g. <font class="file">bcdedit /set {default} ADVANCEDOPTIONS YES</font>).
</li>
</ol>


<ol start="3">
<li>
Install the <font class="file">AoE</font> driver following the instructions in the <a class="glossary" href="aoe_install_winnt6.htm#install">Installing the AoE Driver</a> section of this page. 
</li>
</ol>




<ol start="4">
<li>
If the <font class="file">BCD</font> store was modified in step 2 with the <font class="file">ADVANCEDOPTIONS YES</font> option added, disable this option by running the bcdedit command with <font class="file">ADVANCEDOPTIONS NO</font> - the <font class="file">Advanced Boot Options</font> &gt; <font class="file">Disable Driver Signature Enforcement</font> is only required when installing the driver. 
</li>
</ol>

<p>
<b>NOTE</b> - <font class="file">Test Mode</font> (<font class="file">BCD</font> &gt; <font class="file">TESTSIGNING ON</font>) <u>MUST</u> be left enabled in order for the <font class="file">AoE</font> driver to be loaded for diskless boot.
</p>























<a name="install"></a>
<h2 class="breaktop"><u>Installing the AoE Driver</u></h2>


<p>
Start the <b>Add Hardware Wizard</b> (e.g. windows key + R (to open a <font class="file">Run</font> dialog box) and type <font class="file">hdwwiz.exe</font>) - this should open a windows similar to the screenshot below (<font class="file">Welcome to the Add Hardware Wizard</font>). Click on <b><u>N</u>ext</b> - 
<br />
<img src="img/AoE_win7_img1.jpg" border=1>
</p>




<p class="breaktop">
Select <font class="file">Install the hardware that I manually select from a list (Advanced)</font>, then click on <b>Next</b> - 
<br />
<img src="img/AoE_win7_img2.jpg" border=1>
</p>




<p class="breaktop">
When prompted to <font class="file">select the type of hardware you are installing</font>, scroll down the list and select <font class="file">Storage controllers</font>, then click on <b>Next</b> - 
<br />
<img src="img/AoE_win7_img3.jpg" border=1>
</p>


<p class="breaktop">
When prompted to <font class="file">select the device driver you want to install for this hardware</font>, click on <b>Have Disk...</b> -
<br />
<img src="img/AoE_win7_img4.jpg" border=1>
</p>






<p class="breaktop">
The preceding step will open the <font class="file">Install From Disk</font> window, click on <b>Browse...</b> - 
<br />
<img src="img/AoE_win7_img5.jpg" border=1>
</p>




<p class="breaktop">
Now browse to the folder containing your AoE drivers and select <font class="file">aoe.inf</font> 
</p>





<p class="breaktop">
The folder path to the AoE driver should be displayed in the <font class="file">Copy manufacturer's files from:</font> field. Click on <b>OK</b> -
<br />
<img src="img/AoE_win7_img6.jpg" border=1>
</p>




<p class="breaktop">
Ensure that <font class="file">AoE Driver</font> is displayed in the <font class="file">Model</font> field and click on <b>Next</b> - 
<br />
<img src="img/AoE_win7_img7.jpg" border=1>
</p>




<p class="breaktop">
<font class="file">The wizard is ready to install your hardware</font> screen should now display  the <font class="file">AoE Driver</font>, click on <b>Next</b> -
<br />
<img src="img/AoE_win7_img8.jpg" border=1>
</p>




<p class="breaktop">
A <font class="file">Windows Security</font> warning will be displayed. Click on the <font class="file">Install this driver software anyway</font> option - 
<br />
<img src="img/AoE_win7_img9.jpg" border=1>
</p>




<p class="breaktop">
Assuming the driver installed without any problems you should see a screen similar to the following. Click on <b>Finish</b> - 
<br />
<img src="img/AoE_win7_img10.jpg" border=1>
</p>




<p class="breaktop"><font class="file">Document date - 28<sup>th</sup> February 2017(DRAFT)</font></p></font></body></html>